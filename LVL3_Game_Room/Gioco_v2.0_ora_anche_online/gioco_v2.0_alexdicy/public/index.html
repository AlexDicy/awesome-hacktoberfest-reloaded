<!DOCTYPE html>
<html lang="it">
<head>
  <title>Gioco dell'impiccato</title>
  <link rel="stylesheet" href="style.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">

  <link rel="icon" type="image/png" href="/favicon.png"/>

  <!-- TODO: use production version  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>
<body>

<div id="app">
  <div class="notifications">
    <toast v-for="alert in alerts" :text="alert.text" :title="alert.title" :time="alert.time" @hidden="alert.hideCallback" :key="alert.id"></toast>
  </div>

  <div id="lobby" v-if="showLobby">
    <div class="lobby-title">Lobby</div>
    <div id="lobby-player-list">
      <div v-for="p in players" :key="p.id" class="player" :class="{me: p.id == player.id}">
        <div class="flex">
          <img class="avatar" src="images/player-avatar.svg" alt="">
          <div class="name">{{ p.nickname }}</div>
        </div>
      </div>
      <div class="player not-connected">
        <div class="flex">
          <img class="avatar" src="images/player-avatar.svg" alt="">
          <div class="name">Attesa altri giocatori...</div>
        </div>
      </div>
    </div>
    <button @click="voteToStart" :disabled="disableStartVote || players.length < 2" id="start-vote">Vota per iniziare</button>
  </div>

  <div id="overlay" v-if="overlay.show">
    <div id="overlay-title">{{ overlay.title }}</div>
    <div id="overlay-content">
      {{ overlay.content }}
      <div class="flex" v-if="overlay.showInput">
        <div class="input-group">
          <input type="text" :placeholder="overlay.input.placeholder" id="overlay-input" ref="overlayInput"
                 :minlength="overlay.input.minLength" :required="overlay.input.required" autocomplete="off"
                 @keyup.enter="overlay.input.onSend" v-model="overlay.input.value" autofocus/>
          <div class="shadow"></div>
          <label for="overlay-input" class="input-label">{{ overlay.input.label }}</label>
        </div>
        <button @click="overlay.input.onSend">{{ overlay.input.buttonText }}</button>
      </div>
    </div>
  </div>

  <div class="lives-container">
    <div id="lives">{{ lives }}/{{ totalLives }}</div>
    <img class="lives-heart" src="images/heart.png">
  </div>

  <!--<div class="bottom-info-container">
  <div id="connected-players"></div>
</div>-->

  <div id="keyboard" :class="{'other-turn': player.id != gameInfo.turn.player}">
    <div class="letter">A</div>
    <div class="letter">B</div>
    <div class="letter">C</div>
    <div class="letter">D</div>
    <div class="letter">E</div>
    <div class="letter">F</div>
    <div class="letter">G</div>
    <div class="letter">H</div>
    <div class="letter">I</div>
    <div class="letter">J</div>
    <div class="letter">K</div>
    <div class="letter">L</div>
    <div class="letter">M</div>
    <div class="letter">N</div>
    <div class="letter">O</div>
    <div class="letter">P</div>
    <div class="letter">Q</div>
    <div class="letter">R</div>
    <div class="letter">S</div>
    <div class="letter">T</div>
    <div class="letter">U</div>
    <div class="letter">V</div>
    <div class="letter">W</div>
    <div class="letter">X</div>
    <div class="letter">Y</div>
    <div class="letter">Z</div>
  </div>

  <div class="main-container">
    <div id="hangman-container">
      <div id="hangman">
        <div class="pole1 v-line absolute"></div>
        <div class="pole3 v-line absolute"></div>
        <div class="pole2 h-line absolute"></div>
        <div class="pole4 h-line absolute"></div>
        <div class="base h-line absolute"></div>

        <div id="body" class="absolute">
          <div id="head" class="absolute hide"></div>
          <div id="neck" class="absolute hide"></div>
          <div id="left-arm" class="absolute hide"></div>
          <div id="right-arm" class="absolute hide"></div>
          <div id="waist" class="absolute hide"></div>
          <div id="left-leg" class="absolute hide"></div>
          <div id="right-leg" class="absolute hide"></div>
        </div>
      </div>

      <div id="word-container">
        <div v-for="(letter, index) in gameInfo.letters" :key="index" class="word-letter">{{ letter.letter }}</div>
      </div>
    </div>
    <div class="sidebar">
      <div v-for="p in players" :key="p.id" class="player" :class="{me: p.id == player.id}">
        <img class="turn-arrow" v-if="p.id == gameInfo.turn.player" src="images/turn-arrow.svg" alt="Current turn">
        <div class="flex">
          <div class="avatar">
            <svg class="crown" v-if="gameInfo.chooser && p.id == gameInfo.chooser.id" xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256">
              <g transform="translate(128 128) scale(1.21 1.21)" style="">
                <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;"
                   transform="translate(-104.85 -104.85) scale(2.33 2.33)">
                  <path
                      d="M 78.517 77.617 H 11.483 c -0.951 0 -1.77 -0.669 -1.959 -1.601 L 0.041 29.542 c -0.159 -0.778 0.157 -1.576 0.806 -2.034 c 0.648 -0.459 1.506 -0.489 2.186 -0.079 l 25.585 15.421 l 14.591 -29.358 c 0.335 -0.674 1.021 -1.104 1.774 -1.11 c 0.709 -0.003 1.445 0.411 1.792 1.08 l 15.075 29.1 L 86.968 27.43 c 0.681 -0.41 1.537 -0.379 2.186 0.079 s 0.965 1.256 0.807 2.034 l -9.483 46.474 C 80.286 76.948 79.467 77.617 78.517 77.617 z"
                      fill="currentColor"
                      style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill-rule: nonzero; opacity: 1;"
                      transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
                </g>
              </g>
            </svg>
            <img src="images/player-avatar.svg" alt="">
          </div>
          <div class="name">{{ p.nickname }}</div>
        </div>
      </div>
    </div>
  </div>

  <div class="flex" style="margin-top: 120px">
    <form id="guess-form" class="input-group">
      <input type="text" id="guess-input" required placeholder=" " :disabled="player.id != gameInfo.turn.player" autocomplete="off">
      <div class="shadow"></div>
      <label for="guess-input" class="input-label">Parola</label>
    </form>
    <button type="submit" form="guess-form" :disabled="player.id != gameInfo.turn.player">Indovina</button>
  </div>
</div>

<script src="script.js" type="module"></script>

</body>
</html>
